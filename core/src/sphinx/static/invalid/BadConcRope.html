<h2><b>BadConcRope.scala</b> [<a href="BadConcRope.scala">raw</a>]</h2><br />
<pre><tt><b><font color="#000080">p</font></b><b><font color="#000080">a</font></b><b><font color="#000080">c</font></b><b><font color="#000080">k</font></b><b><font color="#000080">a</font></b><b><font color="#000080">g</font></b><b><font color="#000080">e</font></b> conc
<i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">B</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">R</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">K</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">M</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">@</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">L</font></i><i><font color="#9A1900">A</font></i><i><font color="#9A1900">R</font></i><i><font color="#9A1900">A</font></i><i><font color="#9A1900">,</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">E</font></i><i><font color="#9A1900">P</font></i><i><font color="#9A1900">F</font></i><i><font color="#9A1900">L</font></i><i><font color="#9A1900">.</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">(</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">)</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">E</font></i><i><font color="#9A1900">P</font></i><i><font color="#9A1900">F</font></i><i><font color="#9A1900">L</font></i>

<b><font color="#000080">i</font></b><b><font color="#000080">m</font></b><b><font color="#000080">p</font></b><b><font color="#000080">o</font></b><b><font color="#000080">r</font></b><b><font color="#000080">t</font></b> stainless<font color="#990000">.</font>collection<font color="#990000">.</font><b><font color="#0000FF">_</font></b>
<b><font color="#000080">i</font></b><b><font color="#000080">m</font></b><b><font color="#000080">p</font></b><b><font color="#000080">o</font></b><b><font color="#000080">r</font></b><b><font color="#000080">t</font></b> stainless<font color="#990000">.</font>lang<font color="#990000">.</font><b><font color="#0000FF">_</font></b>
<b><font color="#000080">i</font></b><b><font color="#000080">m</font></b><b><font color="#000080">p</font></b><b><font color="#000080">o</font></b><b><font color="#000080">r</font></b><b><font color="#000080">t</font></b> ListSpecs<font color="#990000">.</font><b><font color="#0000FF">_</font></b>
<b><font color="#000080">i</font></b><b><font color="#000080">m</font></b><b><font color="#000080">p</font></b><b><font color="#000080">o</font></b><b><font color="#000080">r</font></b><b><font color="#000080">t</font></b> stainless<font color="#990000">.</font>annotation<font color="#990000">.</font><b><font color="#0000FF">_</font></b>

<b><font color="#0000FF">o</font></b><b><font color="#0000FF">b</font></b><b><font color="#0000FF">j</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">t</font></b> BadConcRope <font color="#FF0000">{</font>

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>x<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">,</font> y<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">)</font><b><font color="#0000FF">:</font></b> BigInt <b><font color="#0000FF">=</font></b> <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>x <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> y<font color="#990000">)</font> x <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> y
  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">a</font></b><b><font color="#000000">b</font></b><b><font color="#000000">s</font></b><font color="#990000">(</font>x<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">)</font><b><font color="#0000FF">:</font></b> BigInt <b><font color="#0000FF">=</font></b> <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>x <font color="#990000">&lt;</font> <font color="#993399">0</font><font color="#990000">)</font> <font color="#990000">-</font>x <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> x

  <b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">d</font></b> <b><font color="#0000FF">a</font></b><b><font color="#0000FF">b</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">t</font></b> <b><font color="#0000FF">c</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">s</font></b> <font color="#008080">C</font><font color="#008080">o</font><font color="#008080">n</font><font color="#008080">c</font><font color="#990000">[</font>T<font color="#990000">]</font> <font color="#FF0000">{</font>

    <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> isEmpty<b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">t</font></b><b><font color="#0000FF">h</font></b><b><font color="#0000FF">i</font></b><b><font color="#0000FF">s</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font><font color="#990000">)</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> isLeaf<b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">t</font></b><b><font color="#0000FF">h</font></b><b><font color="#0000FF">i</font></b><b><font color="#0000FF">s</font></b> <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font><b><font color="#0000FF">_</font></b><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">f</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> isNormalized<b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">h</font></b><b><font color="#0000FF">i</font></b><b><font color="#0000FF">s</font></b> <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font><b><font color="#0000FF">_</font></b><font color="#990000">,</font> <b><font color="#0000FF">_</font></b><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">f</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> valid<b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
      concInv <font color="#990000">&amp;</font><font color="#990000">&amp;</font> balanced <font color="#990000">&amp;</font><font color="#990000">&amp;</font> appendInv
    <font color="#FF0000">}</font>

    <i><font color="#9A1900">/</font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">*</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">(</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">)</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">-</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">y</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">(</font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">)</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">/</font></i>
    <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> concInv<b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">h</font></b><b><font color="#0000FF">i</font></b><b><font color="#0000FF">s</font></b> <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <font color="#990000">!</font>l<font color="#990000">.</font>isEmpty <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <font color="#990000">!</font>r<font color="#990000">.</font>isEmpty <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
          l<font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font> r<font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
          l<font color="#990000">.</font>concInv <font color="#990000">&amp;</font><font color="#990000">&amp;</font> r<font color="#990000">.</font>concInv
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> balanced<b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">t</font></b><b><font color="#0000FF">h</font></b><b><font color="#0000FF">i</font></b><b><font color="#0000FF">s</font></b> <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
          l<font color="#990000">.</font>level <font color="#990000">-</font> r<font color="#990000">.</font>level <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <font color="#990000">-</font><font color="#993399">1</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> l<font color="#990000">.</font>level <font color="#990000">-</font> r<font color="#990000">.</font>level <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">1</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
            l<font color="#990000">.</font>balanced <font color="#990000">&amp;</font><font color="#990000">&amp;</font> r<font color="#990000">.</font>balanced
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>

    <i><font color="#9A1900">/</font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">*</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">(</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">)</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">R</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">e</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">(</font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">)</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">I</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><font color="#009900">@</font><font color="#009900">A</font><font color="#009900">p</font><font color="#009900">p</font><font color="#009900">e</font><font color="#009900">n</font><font color="#009900">d</font><i><font color="#9A1900">(</font></i><i><font color="#9A1900">b</font></i><font color="#009900">@</font><font color="#009900">A</font><font color="#009900">p</font><font color="#009900">p</font><font color="#009900">e</font><font color="#009900">n</font><font color="#009900">d</font><i><font color="#9A1900">(</font></i><i><font color="#9A1900">_</font></i><i><font color="#9A1900">,</font></i><i><font color="#9A1900">_</font></i><i><font color="#9A1900">)</font></i><i><font color="#9A1900">,</font></i><i><font color="#9A1900">_</font></i><i><font color="#9A1900">)</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">	</font></i><i><font color="#9A1900">	</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">.</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">.</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">&lt;</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">.</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">.</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">l</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">(</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">)</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">y</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">/</font></i>
    <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> appendInv<b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">h</font></b><b><font color="#0000FF">i</font></b><b><font color="#0000FF">s</font></b> <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <font color="#990000">!</font>l<font color="#990000">.</font>isEmpty <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <font color="#990000">!</font>r<font color="#990000">.</font>isEmpty <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
          l<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> r<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
          r<font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
          <font color="#990000">(</font>l <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
            <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font><b><font color="#0000FF">_</font></b><font color="#990000">,</font> lr<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
              lr<font color="#990000">.</font>level <font color="#990000">&gt;</font> r<font color="#990000">.</font>level
            <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
              l<font color="#990000">.</font>level <font color="#990000">&gt;</font> r<font color="#990000">.</font>level
          <font color="#FF0000">}</font><font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
    <font color="#FF0000">}</font>

    <b><font color="#0000FF">v</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b> level<b><font color="#0000FF">:</font></b> BigInt <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
      <font color="#990000">(</font><b><font color="#0000FF">t</font></b><b><font color="#0000FF">h</font></b><b><font color="#0000FF">i</font></b><b><font color="#0000FF">s</font></b> <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <font color="#993399">0</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>x<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <font color="#993399">0</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
          <font color="#993399">1</font> <font color="#990000">+</font> <b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>l<font color="#990000">.</font>level<font color="#990000">,</font> r<font color="#990000">.</font>level<font color="#990000">)</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
          <font color="#993399">1</font> <font color="#990000">+</font> <b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>l<font color="#990000">.</font>level<font color="#990000">,</font> r<font color="#990000">.</font>level<font color="#990000">)</font>
      <font color="#FF0000">}</font><font color="#990000">)</font><b><font color="#0000FF">:</font></b> BigInt
    <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font><b><font color="#0000FF">_</font></b> <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">0</font><font color="#990000">)</font>

    <b><font color="#0000FF">v</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b> size<b><font color="#0000FF">:</font></b> BigInt <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
      <font color="#990000">(</font><b><font color="#0000FF">t</font></b><b><font color="#0000FF">h</font></b><b><font color="#0000FF">i</font></b><b><font color="#0000FF">s</font></b> <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <font color="#993399">0</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>x<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <font color="#993399">1</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
          l<font color="#990000">.</font>size <font color="#990000">+</font> r<font color="#990000">.</font>size
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
          l<font color="#990000">.</font>size <font color="#990000">+</font> r<font color="#990000">.</font>size
      <font color="#FF0000">}</font><font color="#990000">)</font><b><font color="#0000FF">:</font></b> BigInt
    <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font><b><font color="#0000FF">_</font></b> <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">0</font><font color="#990000">)</font>

    <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> toList<b><font color="#0000FF">:</font></b> List<font color="#990000">[</font>T<font color="#990000">]</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">t</font></b><b><font color="#0000FF">h</font></b><b><font color="#0000FF">i</font></b><b><font color="#0000FF">s</font></b> <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <font color="#009900">N</font><font color="#009900">i</font><font color="#009900">l</font><font color="#990000">[</font><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font><font color="#990000">)</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>x<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><font color="#990000">(</font>x<font color="#990000">,</font> <font color="#009900">N</font><font color="#009900">i</font><font color="#009900">l</font><font color="#990000">[</font><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
          l<font color="#990000">.</font>toList <font color="#990000">+</font><font color="#990000">+</font> r<font color="#990000">.</font>toList <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">:</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">t</font></i>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
          l<font color="#990000">.</font>toList <font color="#990000">+</font><font color="#990000">+</font> r<font color="#990000">.</font>toList
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> res<font color="#990000">.</font>size <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">h</font></b><b><font color="#0000FF">i</font></b><b><font color="#0000FF">s</font></b><font color="#990000">.</font>size<font color="#990000">)</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">c</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">s</font></b> <font color="#008080">E</font><font color="#008080">m</font><font color="#008080">p</font><font color="#008080">t</font><font color="#008080">y</font><font color="#990000">[</font><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">x</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">n</font></b><b><font color="#0000FF">d</font></b><b><font color="#0000FF">s</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font>
  <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">c</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">s</font></b> <font color="#008080">S</font><font color="#008080">i</font><font color="#008080">n</font><font color="#008080">g</font><font color="#008080">l</font><font color="#008080">e</font><font color="#990000">[</font><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>x<b><font color="#0000FF">:</font></b> T<font color="#990000">)</font> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">x</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">n</font></b><b><font color="#0000FF">d</font></b><b><font color="#0000FF">s</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font>
  <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">c</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">s</font></b> <font color="#008080">C</font><font color="#008080">C</font><font color="#990000">[</font><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>left<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> right<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">x</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">n</font></b><b><font color="#0000FF">d</font></b><b><font color="#0000FF">s</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font>
  <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">c</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">s</font></b> <font color="#008080">A</font><font color="#008080">p</font><font color="#008080">p</font><font color="#008080">e</font><font color="#008080">n</font><font color="#008080">d</font><font color="#990000">[</font><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>left<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> right<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">x</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">n</font></b><b><font color="#0000FF">d</font></b><b><font color="#0000FF">s</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font>

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">l</font></b><b><font color="#000000">o</font></b><b><font color="#000000">o</font></b><b><font color="#000000">k</font></b><b><font color="#000000">u</font></b><b><font color="#000000">p</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> i<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">)</font><b><font color="#0000FF">:</font></b> T <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <font color="#990000">!</font>xs<font color="#990000">.</font>isEmpty <font color="#990000">&amp;</font><font color="#990000">&amp;</font> i <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">0</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> i <font color="#990000">&lt;</font> xs<font color="#990000">.</font>size<font color="#990000">)</font>
    xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>x<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> x
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>i <font color="#990000">&lt;</font> l<font color="#990000">.</font>size<font color="#990000">)</font> <b><font color="#000000">l</font></b><b><font color="#000000">o</font></b><b><font color="#000000">o</font></b><b><font color="#000000">k</font></b><b><font color="#000000">u</font></b><b><font color="#000000">p</font></b><font color="#990000">(</font>l<font color="#990000">,</font> i<font color="#990000">)</font>
       <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">l</font></b><b><font color="#000000">o</font></b><b><font color="#000000">o</font></b><b><font color="#000000">k</font></b><b><font color="#000000">u</font></b><b><font color="#000000">p</font></b><font color="#990000">(</font>r<font color="#990000">,</font> i <font color="#990000">-</font> l<font color="#990000">.</font>size<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>i <font color="#990000">&lt;</font> l<font color="#990000">.</font>size<font color="#990000">)</font> <b><font color="#000000">l</font></b><b><font color="#000000">o</font></b><b><font color="#000000">o</font></b><b><font color="#000000">k</font></b><b><font color="#000000">u</font></b><b><font color="#000000">p</font></b><font color="#990000">(</font>l<font color="#990000">,</font> i<font color="#990000">)</font>
        <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">l</font></b><b><font color="#000000">o</font></b><b><font color="#000000">o</font></b><b><font color="#000000">k</font></b><b><font color="#000000">u</font></b><b><font color="#000000">p</font></b><font color="#990000">(</font>r<font color="#990000">,</font> i <font color="#990000">-</font> l<font color="#990000">.</font>size<font color="#990000">)</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>  <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><b><font color="#000000">A</font></b><b><font color="#000000">x</font></b><b><font color="#000000">i</font></b><b><font color="#000000">o</font></b><b><font color="#000000">m</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> i<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font>  <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">q</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i>
    res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <b><font color="#000000">x</font></b><b><font color="#000000">s</font></b><b><font color="#000000">.</font></b><b><font color="#000000">t</font></b><b><font color="#000000">o</font></b><b><font color="#000000">L</font></b><b><font color="#000000">i</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><font color="#990000">(</font>i<font color="#990000">)</font><font color="#990000">)</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i>


  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><b><font color="#000000">A</font></b><b><font color="#000000">x</font></b><b><font color="#000000">i</font></b><b><font color="#000000">o</font></b><b><font color="#000000">m</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> i<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">)</font><b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font><font color="#993399">0</font> <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> i <font color="#990000">&amp;</font><font color="#990000">&amp;</font> i <font color="#990000">&lt;</font> xs<font color="#990000">.</font>size<font color="#990000">)</font>
    xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>l<font color="#990000">.</font>toList<font color="#990000">,</font> r<font color="#990000">.</font>toList<font color="#990000">,</font> i<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>l<font color="#990000">.</font>toList<font color="#990000">,</font> r<font color="#990000">.</font>toList<font color="#990000">,</font> i<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font><font color="#990000">.</font>holds

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">u</font></b><b><font color="#000000">p</font></b><b><font color="#000000">d</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">e</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> i<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">,</font> y<b><font color="#0000FF">:</font></b> T<font color="#990000">)</font><b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <font color="#990000">!</font>xs<font color="#990000">.</font>isEmpty <font color="#990000">&amp;</font><font color="#990000">&amp;</font> i <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">0</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> i <font color="#990000">&lt;</font> xs<font color="#990000">.</font>size<font color="#990000">)</font>
    xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>x<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>y<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>i <font color="#990000">&lt;</font> l<font color="#990000">.</font>size<font color="#990000">)</font> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><b><font color="#000000">(</font></b><b><font color="#000000">u</font></b><b><font color="#000000">p</font></b><b><font color="#000000">d</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>l<font color="#990000">,</font> i<font color="#990000">,</font> y<font color="#990000">)</font><font color="#990000">,</font> r<font color="#990000">)</font>
        <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> <b><font color="#000000">u</font></b><b><font color="#000000">p</font></b><b><font color="#000000">d</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>r<font color="#990000">,</font> i <font color="#990000">-</font> l<font color="#990000">.</font>size<font color="#990000">,</font> y<font color="#990000">)</font><font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">(</font></b><!-- open pos = BadConcRope.scala:151:16->151:31--><span style="background-color: Tomato"><b><font color="#000000">u</font></b><b><font color="#000000">p</font></b><b><font color="#000000">d</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>l<font color="#990000">,</font> i<font color="#990000">,</font> y<font color="#990000">)</font></span><!-- close pos = BadConcRope.scala:151:16->151:31--><font color="#990000">,</font> r<font color="#990000">)</font>
<i><font color="#9A1900">// Counterexample for precond. (call update[T](l, i, y)) violation in `update`:</font></i>
<i><font color="#9A1900">//   when i is:</font></i>
<i><font color="#9A1900">//     2</font></i>
<i><font color="#9A1900">//   when xs is:</font></i>
<i><font color="#9A1900">//     Append[T](CC[T](Single[T](T#63), Single[T](T#62)), Single[T](T#64))</font></i>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">U</font></b><b><font color="#000000">p</font></b><b><font color="#000000">d</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">e</font></b><b><font color="#000000">A</font></b><b><font color="#000000">x</font></b><b><font color="#000000">i</font></b><b><font color="#000000">o</font></b><b><font color="#000000">m</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> i<font color="#990000">,</font> y<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i>
    res<font color="#990000">.</font>level <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>level <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">q</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">l</font></i>
    res<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">d</font></i>
    res<font color="#990000">.</font>toList <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <b><font color="#000000">x</font></b><b><font color="#000000">s</font></b><b><font color="#000000">.</font></b><b><font color="#000000">t</font></b><b><font color="#000000">o</font></b><b><font color="#000000">L</font></b><b><font color="#000000">i</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">.</font></b><b><font color="#000000">u</font></b><b><font color="#000000">p</font></b><b><font color="#000000">d</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">e</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>i<font color="#990000">,</font> y<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i>
    <b><font color="#000000">n</font></b><b><font color="#000000">u</font></b><b><font color="#000000">m</font></b><b><font color="#000000">T</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">e</font></b><b><font color="#000000">s</font></b><font color="#990000">(</font>res<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <b><font color="#000000">n</font></b><b><font color="#000000">u</font></b><b><font color="#000000">m</font></b><b><font color="#000000">T</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">e</font></b><b><font color="#000000">s</font></b><font color="#990000">(</font>xs<font color="#990000">)</font><font color="#990000">)</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i>

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">U</font></b><b><font color="#000000">p</font></b><b><font color="#000000">d</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">e</font></b><b><font color="#000000">A</font></b><b><font color="#000000">x</font></b><b><font color="#000000">i</font></b><b><font color="#000000">o</font></b><b><font color="#000000">m</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> i<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">,</font> y<b><font color="#0000FF">:</font></b> T<font color="#990000">)</font><b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>i <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">0</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> i <font color="#990000">&lt;</font> xs<font color="#990000">.</font>size<font color="#990000">)</font>
    xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">U</font></b><b><font color="#000000">p</font></b><b><font color="#000000">d</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>l<font color="#990000">.</font>toList<font color="#990000">,</font> r<font color="#990000">.</font>toList<font color="#990000">,</font> i<font color="#990000">,</font> y<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">U</font></b><b><font color="#000000">p</font></b><b><font color="#000000">d</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>l<font color="#990000">.</font>toList<font color="#990000">,</font> r<font color="#990000">.</font>toList<font color="#990000">,</font> i<font color="#990000">,</font> y<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font><font color="#990000">.</font>holds

  <i><font color="#9A1900">/</font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">*</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">A</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">T</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">/</font></i>
  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> ys<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font><b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> ys<font color="#990000">.</font>valid<font color="#990000">)</font>
    <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">r</font></b><b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">z</font></b><b><font color="#000000">e</font></b><b><font color="#000000">d</font></b><b><font color="#000000">(</font></b><b><font color="#000000">n</font></b><b><font color="#000000">o</font></b><b><font color="#000000">r</font></b><b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">z</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>xs<font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">n</font></b><b><font color="#000000">o</font></b><b><font color="#000000">r</font></b><b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">z</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>ys<font color="#990000">)</font><font color="#990000">)</font>
  <font color="#FF0000">}</font>

  <i><font color="#9A1900">/</font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">*</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">T</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">z</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">.</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">T</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">e</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">/</font></i>
  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">r</font></b><b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">z</font></b><b><font color="#000000">e</font></b><b><font color="#000000">d</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> ys<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font><b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> ys<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
      xs<font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font> ys<font color="#990000">.</font>isNormalized<font color="#990000">)</font>
    <font color="#990000">(</font>xs<font color="#990000">,</font> ys<font color="#990000">)</font> <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#990000">(</font>xs<font color="#990000">,</font> <b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> xs
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#990000">(</font><b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">,</font> ys<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> ys
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> ys<font color="#990000">)</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> res<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>level <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> <b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>level<font color="#990000">,</font> ys<font color="#990000">.</font>level<font color="#990000">)</font> <font color="#990000">+</font> <font color="#993399">1</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>level <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>level<font color="#990000">,</font> ys<font color="#990000">.</font>level<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
    <font color="#990000">(</font>res<font color="#990000">.</font>toList <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>toList <font color="#990000">+</font><font color="#990000">+</font> ys<font color="#990000">.</font>toList<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>isNormalized <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i>
    <font color="#990000">)</font>

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> ys<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font><b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> ys<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
      xs<font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font> ys<font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
      <font color="#990000">!</font>xs<font color="#990000">.</font>isEmpty <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <font color="#990000">!</font>ys<font color="#990000">.</font>isEmpty<font color="#990000">)</font>

    <b><font color="#0000FF">v</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b> diff <b><font color="#0000FF">=</font></b> ys<font color="#990000">.</font>level <font color="#990000">-</font> xs<font color="#990000">.</font>level
    <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>diff <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <font color="#990000">-</font><font color="#993399">1</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> diff <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">1</font><font color="#990000">)</font>
      <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> ys<font color="#990000">)</font>
    <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>diff <font color="#990000">&lt;</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">)</font> <font color="#FF0000">{</font>
      <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">s</font></i>
      xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
          <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>l<font color="#990000">.</font>level <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> r<font color="#990000">.</font>level<font color="#990000">)</font>
            <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font>r<font color="#990000">,</font> ys<font color="#990000">)</font><font color="#990000">)</font>
          <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#FF0000">{</font>
            r <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
              <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>rl<font color="#990000">,</font> rr<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
                <b><font color="#0000FF">v</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b> nrr <b><font color="#0000FF">=</font></b> <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font>rr<font color="#990000">,</font> ys<font color="#990000">)</font>
                <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>nrr<font color="#990000">.</font>level <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>level <font color="#990000">-</font> <font color="#993399">3</font><font color="#990000">)</font> <font color="#FF0000">{</font>
                  <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>rl<font color="#990000">,</font> nrr<font color="#990000">)</font><font color="#990000">)</font>
                <font color="#FF0000">}</font> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#FF0000">{</font>
                  <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><b><font color="#000000">(</font></b><b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> rl<font color="#990000">)</font><font color="#990000">,</font> nrr<font color="#990000">)</font>
                <font color="#FF0000">}</font>
            <font color="#FF0000">}</font>
          <font color="#FF0000">}</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#FF0000">{</font>
      ys <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
          <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>r<font color="#990000">.</font>level <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> l<font color="#990000">.</font>level<font color="#990000">)</font> <font color="#FF0000">{</font>
            <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><b><font color="#000000">(</font></b><b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> l<font color="#990000">)</font><font color="#990000">,</font> r<font color="#990000">)</font>
          <font color="#FF0000">}</font> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#FF0000">{</font>
            l <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
              <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>ll<font color="#990000">,</font> lr<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
                <b><font color="#0000FF">v</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b> nll <b><font color="#0000FF">=</font></b> <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> ll<font color="#990000">)</font>
                <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>nll<font color="#990000">.</font>level <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> ys<font color="#990000">.</font>level <font color="#990000">-</font> <font color="#993399">3</font><font color="#990000">)</font> <font color="#FF0000">{</font>
                  <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><b><font color="#000000">(</font></b><b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>nll<font color="#990000">,</font> lr<font color="#990000">)</font><font color="#990000">,</font> r<font color="#990000">)</font>
                <font color="#FF0000">}</font> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#FF0000">{</font>
                  <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>nll<font color="#990000">,</font> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>lr<font color="#990000">,</font> r<font color="#990000">)</font><font color="#990000">)</font>
                <font color="#FF0000">}</font>
            <font color="#FF0000">}</font>
          <font color="#FF0000">}</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
    <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> ys<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">m</font></i>
    res<font color="#990000">.</font>level <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> <b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>level<font color="#990000">,</font> ys<font color="#990000">.</font>level<font color="#990000">)</font> <font color="#990000">+</font> <font color="#993399">1</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>level <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>level<font color="#990000">,</font> ys<font color="#990000">.</font>level<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
    res<font color="#990000">.</font>balanced <font color="#990000">&amp;</font><font color="#990000">&amp;</font> res<font color="#990000">.</font>appendInv <font color="#990000">&amp;</font><font color="#990000">&amp;</font> res<font color="#990000">.</font>concInv <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">d</font></i>
    res<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">d</font></i>
    res<font color="#990000">.</font>toList <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>toList <font color="#990000">+</font><font color="#990000">+</font> ys<font color="#990000">.</font>toList <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>isNormalized <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i>
    <font color="#990000">)</font>


  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> ys<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font><b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <font color="#990000">(</font>xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><font color="#990000">(</font>l<font color="#990000">.</font>toList<font color="#990000">,</font> r<font color="#990000">.</font>toList<font color="#990000">,</font> ys<font color="#990000">.</font>toList<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i>
          <font color="#990000">(</font>r <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
            <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>rl<font color="#990000">,</font> rr<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
              <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><font color="#990000">(</font>rl<font color="#990000">.</font>toList<font color="#990000">,</font> rr<font color="#990000">.</font>toList<font color="#990000">,</font> ys<font color="#990000">.</font>toList<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
                <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><font color="#990000">(</font>l<font color="#990000">.</font>toList<font color="#990000">,</font> rl<font color="#990000">.</font>toList<font color="#990000">,</font> rr<font color="#990000">.</font>toList <font color="#990000">+</font><font color="#990000">+</font> ys<font color="#990000">.</font>toList<font color="#990000">)</font>
            <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
          <font color="#FF0000">}</font><font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
    <font color="#FF0000">}</font><font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
      <font color="#990000">(</font>ys <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
          <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>toList<font color="#990000">,</font> l<font color="#990000">.</font>toList<font color="#990000">,</font> r<font color="#990000">.</font>toList<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
            <font color="#990000">(</font>l <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
              <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>ll<font color="#990000">,</font> lr<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
                <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>toList<font color="#990000">,</font> ll<font color="#990000">.</font>toList<font color="#990000">,</font> lr<font color="#990000">.</font>toList<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
                  <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>toList <font color="#990000">+</font><font color="#990000">+</font> ll<font color="#990000">.</font>toList<font color="#990000">,</font> lr<font color="#990000">.</font>toList<font color="#990000">,</font> r<font color="#990000">.</font>toList<font color="#990000">)</font>
              <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
            <font color="#FF0000">}</font><font color="#990000">)</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
      <font color="#FF0000">}</font><font color="#990000">)</font>
  <font color="#FF0000">}</font><font color="#990000">.</font>holds


  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> i<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">,</font> y<b><font color="#0000FF">:</font></b> T<font color="#990000">)</font><b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> i <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">0</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> i <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>size <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
      xs<font color="#990000">.</font>isNormalized<font color="#990000">)</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i>
    xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>y<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>x<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>i <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <font color="#993399">0</font><font color="#990000">)</font>
          <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><b><font color="#000000">(</font></b><b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>y<font color="#990000">)</font><font color="#990000">,</font> xs<font color="#990000">)</font>
        <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b>
          <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>y<font color="#990000">)</font><font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> i <font color="#990000">&lt;</font> l<font color="#990000">.</font>size <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><b><font color="#000000">(</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><font color="#990000">(</font>l<font color="#990000">,</font> i<font color="#990000">,</font> y<font color="#990000">)</font><font color="#990000">,</font> r<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
       <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font>l<font color="#990000">,</font> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><font color="#990000">(</font>r<font color="#990000">,</font> i <font color="#990000">-</font> l<font color="#990000">.</font>size<font color="#990000">,</font> y<font color="#990000">)</font><font color="#990000">)</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">x</font></b><b><font color="#000000">i</font></b><b><font color="#000000">o</font></b><b><font color="#000000">m</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> i<font color="#990000">,</font> y<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">m</font></i>
    res<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> res<font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>level <font color="#990000">-</font> xs<font color="#990000">.</font>level <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">1</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> res<font color="#990000">.</font>level <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>level <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">1</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i>
    res<font color="#990000">.</font>toList <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">t</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>toList<font color="#990000">,</font> i<font color="#990000">,</font> y<font color="#990000">)</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i>
    <font color="#990000">)</font>

  <i><font color="#9A1900">/</font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">*</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">U</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">y</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">.</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">/</font></i>
  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">t</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>l<b><font color="#0000FF">:</font></b> List<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> i<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">,</font> y<b><font color="#0000FF">:</font></b> T<font color="#990000">)</font><b><font color="#0000FF">:</font></b> List<font color="#990000">[</font>T<font color="#990000">]</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font><font color="#993399">0</font> <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> i <font color="#990000">&amp;</font><font color="#990000">&amp;</font> i <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> l<font color="#990000">.</font>size<font color="#990000">)</font>
    l <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#009900">N</font><font color="#009900">i</font><font color="#009900">l</font><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">C</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>y<font color="#990000">,</font> <font color="#009900">N</font><font color="#009900">i</font><font color="#009900">l</font><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> i <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <font color="#993399">0</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">C</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>y<font color="#990000">,</font> l<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><font color="#990000">(</font>x<font color="#990000">,</font> tail<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">C</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>x<font color="#990000">,</font> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">t</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>tail<font color="#990000">,</font> i <font color="#990000">-</font> <font color="#993399">1</font><font color="#990000">,</font> y<font color="#990000">)</font><font color="#990000">)</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">A</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">`</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">`</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">`</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">A</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">I</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">`</font></i>
  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>l1<b><font color="#0000FF">:</font></b> List<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> l2<b><font color="#0000FF">:</font></b> List<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> i<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">,</font> y<b><font color="#0000FF">:</font></b> T<font color="#990000">)</font><b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font><font color="#993399">0</font> <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> i <font color="#990000">&amp;</font><font color="#990000">&amp;</font> i <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> l1<font color="#990000">.</font>size <font color="#990000">+</font> l2<font color="#990000">.</font>size<font color="#990000">)</font>
    <font color="#990000">(</font>l1 <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#009900">N</font><font color="#009900">i</font><font color="#009900">l</font><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><font color="#990000">(</font>x<font color="#990000">,</font> xs<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>i <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <font color="#993399">0</font><font color="#990000">)</font> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> l2<font color="#990000">,</font> i <font color="#990000">-</font> <font color="#993399">1</font><font color="#990000">,</font> y<font color="#990000">)</font>
    <font color="#FF0000">}</font><font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
      <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">a</font></i>
      <font color="#990000">(</font><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">t</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><b><font color="#000000">(</font></b><font color="#990000">(</font>l1 <font color="#990000">+</font><font color="#990000">+</font> l2<font color="#990000">)</font><font color="#990000">,</font> i<font color="#990000">,</font> y<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <font color="#990000">(</font>
        <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>i <font color="#990000">&lt;</font> l1<font color="#990000">.</font>size<font color="#990000">)</font> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">t</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>l1<font color="#990000">,</font> i<font color="#990000">,</font> y<font color="#990000">)</font> <font color="#990000">+</font><font color="#990000">+</font> l2
        <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> l1 <font color="#990000">+</font><font color="#990000">+</font> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">t</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><b><font color="#000000">(</font></b><b><font color="#000000">l</font></b><b><font color="#000000">2</font></b><b><font color="#000000">,</font></b> <font color="#990000">(</font>i <font color="#990000">-</font> l1<font color="#990000">.</font>size<font color="#990000">)</font><font color="#990000">,</font> y<font color="#990000">)</font><font color="#990000">)</font><font color="#990000">)</font>
  <font color="#FF0000">}</font><font color="#990000">.</font>holds

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">x</font></b><b><font color="#000000">i</font></b><b><font color="#000000">o</font></b><b><font color="#000000">m</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> i<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">,</font> y<b><font color="#0000FF">:</font></b> T<font color="#990000">)</font><b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>i <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">0</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> i <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>size<font color="#990000">)</font>
    xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">e</font></b><b><font color="#000000">r</font></b><b><font color="#000000">t</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">e</font></b><b><font color="#000000">x</font></b><font color="#990000">(</font>l<font color="#990000">.</font>toList<font color="#990000">,</font> r<font color="#990000">.</font>toList<font color="#990000">,</font> i<font color="#990000">,</font> y<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font><font color="#990000">.</font>holds

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">s</font></b><b><font color="#000000">p</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">t</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> n<b><font color="#0000FF">:</font></b> <b><font color="#000000">B</font></b><b><font color="#000000">i</font></b><b><font color="#000000">g</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">t</font></b><b><font color="#000000">)</font></b><b><font color="#000000">:</font></b> <font color="#990000">(</font>Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> xs<font color="#990000">.</font>isNormalized<font color="#990000">)</font>
    xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <font color="#990000">(</font><b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> s <b><font color="#0000FF">@</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>x<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>n <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">0</font><font color="#990000">)</font> <font color="#FF0000">{</font>
          <font color="#990000">(</font><b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">,</font> s<font color="#990000">)</font>
        <font color="#FF0000">}</font> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#FF0000">{</font>
          <font color="#990000">(</font>s<font color="#990000">,</font> <b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font>
        <font color="#FF0000">}</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>n <font color="#990000">&lt;</font> l<font color="#990000">.</font>size<font color="#990000">)</font> <font color="#FF0000">{</font>
          <b><font color="#0000FF">v</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b> <font color="#990000">(</font>ll<font color="#990000">,</font> lr<font color="#990000">)</font> <b><font color="#0000FF">=</font></b> <b><font color="#000000">s</font></b><b><font color="#000000">p</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">t</font></b><font color="#990000">(</font>l<font color="#990000">,</font> n<font color="#990000">)</font>
          <font color="#990000">(</font>ll<font color="#990000">,</font> <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">r</font></b><b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">z</font></b><b><font color="#000000">e</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>lr<font color="#990000">,</font> r<font color="#990000">)</font><font color="#990000">)</font>
        <font color="#FF0000">}</font> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>n <font color="#990000">&gt;</font> l<font color="#990000">.</font>size<font color="#990000">)</font> <font color="#FF0000">{</font>
          <b><font color="#0000FF">v</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b> <font color="#990000">(</font>rl<font color="#990000">,</font> rr<font color="#990000">)</font> <b><font color="#0000FF">=</font></b> <b><font color="#000000">s</font></b><b><font color="#000000">p</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">t</font></b><font color="#990000">(</font>r<font color="#990000">,</font> n <font color="#990000">-</font> l<font color="#990000">.</font>size<font color="#990000">)</font>
          <font color="#990000">(</font><b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">r</font></b><b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">z</font></b><b><font color="#000000">e</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> rl<font color="#990000">)</font><font color="#990000">,</font> rr<font color="#990000">)</font>
        <font color="#FF0000">}</font> <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#FF0000">{</font>
          <font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font>
        <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res  <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">S</font></b><b><font color="#000000">p</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">x</font></b><b><font color="#000000">i</font></b><b><font color="#000000">o</font></b><b><font color="#000000">m</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> n<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">m</font></i>
    res<font color="#990000">.</font><b><font color="#0000FF">_</font></b><font color="#993399">1</font><font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> res<font color="#990000">.</font><b><font color="#0000FF">_</font></b><font color="#993399">2</font><font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">d</font></i>
    res<font color="#990000">.</font><b><font color="#0000FF">_</font></b><font color="#993399">1</font><font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font> res<font color="#990000">.</font><b><font color="#0000FF">_</font></b><font color="#993399">2</font><font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
    xs<font color="#990000">.</font>level <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> res<font color="#990000">.</font><b><font color="#0000FF">_</font></b><font color="#993399">1</font><font color="#990000">.</font>level <font color="#990000">&amp;</font><font color="#990000">&amp;</font> xs<font color="#990000">.</font>level <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> res<font color="#990000">.</font><b><font color="#0000FF">_</font></b><font color="#993399">2</font><font color="#990000">.</font>level <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i>
    res<font color="#990000">.</font><b><font color="#0000FF">_</font></b><font color="#993399">1</font><font color="#990000">.</font>toList <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <b><font color="#000000">x</font></b><b><font color="#000000">s</font></b><b><font color="#000000">.</font></b><b><font color="#000000">t</font></b><b><font color="#000000">o</font></b><b><font color="#000000">L</font></b><b><font color="#000000">i</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">.</font></b><b><font color="#000000">t</font></b><b><font color="#000000">a</font></b><b><font color="#000000">k</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>n<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> res<font color="#990000">.</font><b><font color="#0000FF">_</font></b><font color="#993399">2</font><font color="#990000">.</font>toList <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> <b><font color="#000000">x</font></b><b><font color="#000000">s</font></b><b><font color="#000000">.</font></b><b><font color="#000000">t</font></b><b><font color="#000000">o</font></b><b><font color="#000000">L</font></b><b><font color="#000000">i</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">.</font></b><b><font color="#000000">d</font></b><b><font color="#000000">r</font></b><b><font color="#000000">o</font></b><b><font color="#000000">p</font></b><font color="#990000">(</font>n<font color="#990000">)</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i>
    <font color="#990000">)</font>

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">S</font></b><b><font color="#000000">p</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">t</font></b><b><font color="#000000">A</font></b><b><font color="#000000">x</font></b><b><font color="#000000">i</font></b><b><font color="#000000">o</font></b><b><font color="#000000">m</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> n<b><font color="#0000FF">:</font></b> BigInt<font color="#990000">)</font><b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">T</font></b><b><font color="#000000">a</font></b><b><font color="#000000">k</font></b><b><font color="#000000">e</font></b><b><font color="#000000">D</font></b><b><font color="#000000">r</font></b><b><font color="#000000">o</font></b><b><font color="#000000">p</font></b><font color="#990000">(</font>l<font color="#990000">.</font>toList<font color="#990000">,</font> r<font color="#990000">.</font>toList<font color="#990000">,</font> n<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font><font color="#990000">.</font>holds

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> x<b><font color="#0000FF">:</font></b> T<font color="#990000">)</font><b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>valid<font color="#990000">)</font>
    <b><font color="#0000FF">v</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b> ys <b><font color="#0000FF">=</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>x<font color="#990000">)</font>
    xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> xs <b><font color="#0000FF">@</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font><b><font color="#0000FF">_</font></b><font color="#990000">,</font> <b><font color="#0000FF">_</font></b><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">P</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">v</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> ys<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font><b><font color="#0000FF">_</font></b><font color="#990000">,</font> <b><font color="#0000FF">_</font></b><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> ys<font color="#990000">)</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">g</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900">e</font></i>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">E</font></b><b><font color="#000000">m</font></b><b><font color="#000000">p</font></b><b><font color="#000000">t</font></b><b><font color="#000000">y</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> ys
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">S</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b><b><font color="#000000">l</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font><b><font color="#0000FF">_</font></b><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> ys<font color="#990000">)</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> res<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>toList <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>toList <font color="#990000">+</font><font color="#990000">+</font> <b><font color="#000000">C</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><font color="#990000">(</font>x<font color="#990000">,</font> <font color="#009900">N</font><font color="#009900">i</font><font color="#009900">l</font><font color="#990000">[</font><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>level <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>level <font color="#990000">+</font> <font color="#993399">1</font>
  <font color="#990000">)</font>

  <i><font color="#9A1900">/</font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">*</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">T</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">f</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">*</font></i><i><font color="#9A1900">/</font></i>
  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">P</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">v</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Append<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> ys<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font><b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font>  <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> ys<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
      <font color="#990000">!</font>ys<font color="#990000">.</font>isEmpty <font color="#990000">&amp;</font><font color="#990000">&amp;</font> ys<font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
      xs<font color="#990000">.</font>right<font color="#990000">.</font>level <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> ys<font color="#990000">.</font>level<font color="#990000">)</font>

    <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> <font color="#990000">(</font>xs<font color="#990000">.</font>right<font color="#990000">.</font>level <font color="#990000">&gt;</font> ys<font color="#990000">.</font>level<font color="#990000">)</font>
      <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> ys<font color="#990000">)</font>
    <b><font color="#0000FF">e</font></b><b><font color="#0000FF">l</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">v</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b> zs <b><font color="#0000FF">=</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>right<font color="#990000">,</font> ys<font color="#990000">)</font>
      xs<font color="#990000">.</font>left <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> l <b><font color="#0000FF">@</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font><b><font color="#0000FF">_</font></b><font color="#990000">,</font> <b><font color="#0000FF">_</font></b><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">P</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">v</font></b><font color="#990000">(</font>l<font color="#990000">,</font> zs<font color="#990000">)</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> l <b><font color="#0000FF">i</font></b><b><font color="#0000FF">f</font></b> l<font color="#990000">.</font>level <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> zs<font color="#990000">.</font>level <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">:</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">&lt;</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">b</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i>
          <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> zs<font color="#990000">)</font>
        <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> l <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
          <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> zs<font color="#990000">)</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">2</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> ys<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
    res<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>toList <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>toList <font color="#990000">+</font><font color="#990000">+</font> ys<font color="#990000">.</font>toList <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>level <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>level <font color="#990000">+</font> <font color="#993399">1</font> <font color="#990000">)</font>

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">2</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> ys<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font><b><font color="#0000FF">:</font></b> <font color="#009900">B</font><font color="#009900">o</font><font color="#009900">o</font><font color="#009900">l</font><font color="#009900">e</font><font color="#009900">a</font><font color="#009900">n</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    xs <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">C</font></b><b><font color="#000000">C</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><font color="#990000">(</font>l<font color="#990000">.</font>toList<font color="#990000">,</font> r<font color="#990000">.</font>toList<font color="#990000">,</font> ys<font color="#990000">.</font>toList<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><font color="#990000">(</font>l<font color="#990000">.</font>toList<font color="#990000">,</font> r<font color="#990000">.</font>toList<font color="#990000">,</font> ys<font color="#990000">.</font>toList<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#0000FF">t</font></b><b><font color="#0000FF">r</font></b><b><font color="#0000FF">u</font></b><b><font color="#0000FF">e</font></b>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font><font color="#990000">.</font>holds

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">n</font></b><b><font color="#000000">u</font></b><b><font color="#000000">m</font></b><b><font color="#000000">T</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">e</font></b><b><font color="#000000">s</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>t<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font><b><font color="#0000FF">:</font></b> BigInt <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    t <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">n</font></b><b><font color="#000000">u</font></b><b><font color="#000000">m</font></b><b><font color="#000000">T</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">e</font></b><b><font color="#000000">s</font></b><font color="#990000">(</font>l<font color="#990000">)</font> <font color="#990000">+</font> <font color="#993399">1</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">B</font></b><b><font color="#000000">i</font></b><b><font color="#000000">g</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">t</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">)</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> res <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> <font color="#993399">0</font><font color="#990000">)</font>

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">n</font></b><b><font color="#000000">o</font></b><b><font color="#000000">r</font></b><b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">z</font></b><b><font color="#000000">e</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>t<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font><b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>t<font color="#990000">.</font>valid<font color="#990000">)</font>
    t <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l <b><font color="#0000FF">@</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font><b><font color="#0000FF">_</font></b><font color="#990000">,</font> <b><font color="#0000FF">_</font></b><font color="#990000">)</font><font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">w</font></b><b><font color="#000000">r</font></b><b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">r</font></b><b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">z</font></b><b><font color="#000000">e</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> <b><font color="#0000FF">_</font></b> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> t
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> res<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
    res<font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
    res<font color="#990000">.</font>toList <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> t<font color="#990000">.</font>toList <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>size <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> t<font color="#990000">.</font>size <font color="#990000">&amp;</font><font color="#990000">&amp;</font> res<font color="#990000">.</font>level <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> t<font color="#990000">.</font>level <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">z</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">v</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">d</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">z</font></i><i><font color="#9A1900">e</font></i>
    <font color="#990000">)</font>

  <b><font color="#0000FF">d</font></b><b><font color="#0000FF">e</font></b><b><font color="#0000FF">f</font></b> <b><font color="#000000">w</font></b><b><font color="#000000">r</font></b><b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">[</font></b><b><font color="#000000">T</font></b><b><font color="#000000">]</font></b><font color="#990000">(</font>xs<b><font color="#0000FF">:</font></b> Append<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">,</font> ys<b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font><font color="#990000">)</font><b><font color="#0000FF">:</font></b> Conc<font color="#990000">[</font>T<font color="#990000">]</font> <b><font color="#0000FF">=</font></b> <font color="#FF0000">{</font>
    <b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><b><font color="#000000">q</font></b><b><font color="#000000">u</font></b><b><font color="#000000">i</font></b><b><font color="#000000">r</font></b><b><font color="#000000">e</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> ys<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font> ys<font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
      xs<font color="#990000">.</font>right<font color="#990000">.</font>level <font color="#990000">&gt;</font><b><font color="#0000FF">=</font></b> ys<font color="#990000">.</font>level<font color="#990000">)</font>
    <b><font color="#0000FF">v</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">l</font></b> nr  <b><font color="#0000FF">=</font></b> <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">r</font></b><b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">z</font></b><b><font color="#000000">e</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>xs<font color="#990000">.</font>right<font color="#990000">,</font> ys<font color="#990000">)</font>
    xs<font color="#990000">.</font>left <b><font color="#0000FF">m</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">t</font></b><b><font color="#0000FF">c</font></b><b><font color="#0000FF">h</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> l <b><font color="#0000FF">@</font></b> <b><font color="#000000">A</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font><b><font color="#0000FF">_</font></b><font color="#990000">,</font> <b><font color="#0000FF">_</font></b><font color="#990000">)</font> <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b> <b><font color="#000000">w</font></b><b><font color="#000000">r</font></b><b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><font color="#990000">(</font>l<font color="#990000">,</font> nr<font color="#990000">)</font>
      <b><font color="#0000FF">c</font></b><b><font color="#0000FF">a</font></b><b><font color="#0000FF">s</font></b><b><font color="#0000FF">e</font></b> l <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
        <b><font color="#000000">c</font></b><b><font color="#000000">o</font></b><b><font color="#000000">n</font></b><b><font color="#000000">c</font></b><b><font color="#000000">a</font></b><b><font color="#000000">t</font></b><b><font color="#000000">N</font></b><b><font color="#000000">o</font></b><b><font color="#000000">r</font></b><b><font color="#000000">m</font></b><b><font color="#000000">a</font></b><b><font color="#000000">l</font></b><b><font color="#000000">i</font></b><b><font color="#000000">z</font></b><b><font color="#000000">e</font></b><b><font color="#000000">d</font></b><font color="#990000">(</font>l<font color="#990000">,</font> nr<font color="#990000">)</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font> <b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">u</font></b><b><font color="#000000">r</font></b><b><font color="#000000">i</font></b><b><font color="#000000">n</font></b><b><font color="#000000">g</font></b> <font color="#990000">(</font>res <b><font color="#0000FF">=</font></b><b><font color="#0000FF">&gt;</font></b>
    <b><font color="#000000">a</font></b><b><font color="#000000">p</font></b><b><font color="#000000">p</font></b><b><font color="#000000">e</font></b><b><font color="#000000">n</font></b><b><font color="#000000">d</font></b><b><font color="#000000">A</font></b><b><font color="#000000">s</font></b><b><font color="#000000">s</font></b><b><font color="#000000">o</font></b><b><font color="#000000">c</font></b><b><font color="#000000">I</font></b><b><font color="#000000">n</font></b><b><font color="#000000">s</font></b><b><font color="#000000">t</font></b><b><font color="#000000">2</font></b><font color="#990000">(</font>xs<font color="#990000">,</font> ys<font color="#990000">)</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">m</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>valid <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
    res<font color="#990000">.</font>isNormalized <font color="#990000">&amp;</font><font color="#990000">&amp;</font>
    res<font color="#990000">.</font>toList <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>toList <font color="#990000">+</font><font color="#990000">+</font> ys<font color="#990000">.</font>toList <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">c</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">n</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>size <b><font color="#0000FF">=</font></b><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>size <font color="#990000">+</font> ys<font color="#990000">.</font>size <font color="#990000">&amp;</font><font color="#990000">&amp;</font> <i><font color="#9A1900">/</font></i><i><font color="#9A1900">/</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">h</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">u</font></i><i><font color="#9A1900">x</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">l</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">a</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">y</font></i><i><font color="#9A1900"> </font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">o</font></i><i><font color="#9A1900">p</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">r</font></i><i><font color="#9A1900">t</font></i><i><font color="#9A1900">i</font></i><i><font color="#9A1900">e</font></i><i><font color="#9A1900">s</font></i>
    res<font color="#990000">.</font>level <font color="#990000">&lt;</font><b><font color="#0000FF">=</font></b> xs<font color="#990000">.</font>level
    <font color="#990000">)</font>
<font color="#FF0000">}</font>
</tt></pre>
